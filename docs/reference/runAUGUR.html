<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Prioritize cell types involved in a biological process. — runAUGUR • scMiko</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Prioritize cell types involved in a biological process. — runAUGUR" />
<meta property="og:description" content="Augur::calculate_auc(...) function adopted for Windows (i.e. parallel implementation supported)." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">scMiko</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Getting Started
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Computational Resources</li>
    <li>
      <a href="../articles/install.html">scMiko Package</a>
    </li>
    <li>
      <a href="../articles/scPipeline_getting_started.html">scPipeline Reports</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">scMiko Vignettes</li>
    <li>
      <a href="../articles/DEG.html">Differential-expression using CDI</a>
    </li>
    <li>
      <a href="../articles/Cluster_Optimization.html">Selecting cluster resolution using specificity criterion</a>
    </li>
    <li>
      <a href="../articles/Marker_Catalog.html">Cell-type marker catalog</a>
    </li>
    <li>
      <a href="../articles/Cell_Annotation.html">Marker-based cell-type annotation using Miko Scoring</a>
    </li>
    <li>
      <a href="../articles/Module_Detection.html">Gene program discovery using SSN analysis</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">scPipeline Dashboard Reports</li>
    <li>
      <a href="../articles/scPipeline_module_overview.html">Overview of modules</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/NMikolajewicz/scMiko">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Prioritize cell types involved in a biological process.</h1>
    
    <div class="hidden name"><code>runAUGUR.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Augur::calculate_auc(...) function adopted for Windows (i.e. parallel implementation supported).</p>
    </div>

    <pre class="usage"><span class='fu'>runAUGUR</span><span class='op'>(</span>
  <span class='va'>input</span>,
  meta <span class='op'>=</span> <span class='cn'>NULL</span>,
  label_col <span class='op'>=</span> <span class='st'>"label"</span>,
  cell_type_col <span class='op'>=</span> <span class='st'>"cell_type"</span>,
  n_subsamples <span class='op'>=</span> <span class='fl'>50</span>,
  subsample_size <span class='op'>=</span> <span class='fl'>20</span>,
  folds <span class='op'>=</span> <span class='fl'>3</span>,
  min_cells <span class='op'>=</span> <span class='cn'>NULL</span>,
  var_quantile <span class='op'>=</span> <span class='fl'>0.5</span>,
  feature_perc <span class='op'>=</span> <span class='fl'>0.5</span>,
  n_threads <span class='op'>=</span> <span class='fl'>4</span>,
  show_progress <span class='op'>=</span> <span class='cn'>T</span>,
  augur_mode <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"default"</span>, <span class='st'>"velocity"</span>, <span class='st'>"permute"</span><span class='op'>)</span>,
  classifier <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"rf"</span>, <span class='st'>"lr"</span><span class='op'>)</span>,
  rf_params <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>trees <span class='op'>=</span> <span class='fl'>100</span>, mtry <span class='op'>=</span> <span class='fl'>2</span>, min_n <span class='op'>=</span> <span class='cn'>NULL</span>, importance <span class='op'>=</span> <span class='st'>"accuracy"</span><span class='op'>)</span>,
  lr_params <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>mixture <span class='op'>=</span> <span class='fl'>1</span>, penalty <span class='op'>=</span> <span class='st'>"auto"</span><span class='op'>)</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>input</th>
      <td><p>a matrix, data frame, or <code>Seurat</code>, <code>monocle</code>, or
<code>SingleCellExperiment</code> object containing gene expression values
(genes in rows, cells in columns) and, optionally, metadata about each cell</p></td>
    </tr>
    <tr>
      <th>meta</th>
      <td><p>a data frame containing metadata about the <code>input</code>
gene-by-cell matrix, at minimum containing the cell type for each cell
and the labels (e.g., group, disease, timepoint); can be left as
<code>NULL</code> if <code>input</code> is a <code>Seurat</code> or <code>monocle</code> object</p></td>
    </tr>
    <tr>
      <th>label_col</th>
      <td><p>the column of the <code>meta</code> data frame, or the
metadata container in the <code>Seurat</code> or <code>monocle</code> object, that
contains condition labels (e.g., disease, timepoint) for each cell in the
gene-by-cell expression matrix; defaults to <code>label</code></p></td>
    </tr>
    <tr>
      <th>cell_type_col</th>
      <td><p>the column of the <code>meta</code> data frame, or the
metadata container in the <code>Seurat</code>/<code>monocle</code> object, that
contains cell type labels for each cell in the gene-by-cell expression
matrix; defaults to <code>cell_type</code></p></td>
    </tr>
    <tr>
      <th>n_subsamples</th>
      <td><p>the number of random subsamples of fixed size to
draw from the complete dataset, for each cell type; defaults to <code>50</code>.
Set to <code>0</code> to omit subsampling altogether,
calculating performance on the entire dataset, but note that this may
introduce bias due to cell type or label class imbalance.
Note that when setting <code>augur_mode = "permute"</code>, values less than
<code>100</code> will be replaced with a default of <code>500</code>.</p></td>
    </tr>
    <tr>
      <th>subsample_size</th>
      <td><p>the number of cells per type to subsample randomly from
each experimental condition, if <code>n_subsamples</code> is greater than 1;
defaults to <code>20</code></p></td>
    </tr>
    <tr>
      <th>folds</th>
      <td><p>the number of folds of cross-validation to run; defaults to
<code>3</code>. Be careful changing this parameter without also changing
<code>subsample_size</code></p></td>
    </tr>
    <tr>
      <th>min_cells</th>
      <td><p>the minimum number of cells for a particular cell type in
each condition in order to retain that type for analysis;
defaults to <code>subsample_size</code></p></td>
    </tr>
    <tr>
      <th>var_quantile</th>
      <td><p>the quantile of highly variable genes to retain for
each cell type using the variable gene filter (select_variance);
defaults to <code>0.5</code></p></td>
    </tr>
    <tr>
      <th>feature_perc</th>
      <td><p>the proportion of genes that are randomly selected as
features for input to the classifier in each subsample using the
random gene filter (select_random); defaults to <code>0.5</code></p></td>
    </tr>
    <tr>
      <th>n_threads</th>
      <td><p>the number of threads to use for parallelization;
defaults to <code>4</code>.</p></td>
    </tr>
    <tr>
      <th>show_progress</th>
      <td><p>if <code>TRUE</code>, display a progress bar for the analysis
with estimated time remaining</p></td>
    </tr>
    <tr>
      <th>augur_mode</th>
      <td><p>one of <code>"default"</code>, <code>"velocity"</code>, or
<code>"permute"</code>. Setting <code>augur_mode = "velocity"</code> disables feature
selection, assuming feature selection has been performed by the RNA
velocity procedure to produce the input matrix, while setting
<code>augur_mode = "permute"</code> will generate a null distribution of AUCs
for each cell type by permuting the labels</p></td>
    </tr>
    <tr>
      <th>classifier</th>
      <td><p>the classifier to use in calculating area under the curve,
one of <code>"rf"</code> (random forest) or <code>"lr"</code> (logistic regression);
defaults to <code>"rf"</code>, which is the recommended setting</p></td>
    </tr>
    <tr>
      <th>rf_params</th>
      <td><p>for <code>classifier</code> == <code>"rf"</code>, a list of parameters
for the random forest models, containing the following items (see
<a href='https://parsnip.tidymodels.org/reference/rand_forest.html'>rand_forest</a> from the <code>parsnip</code> package):</p><dl>
  <dt>"mtry"</dt><dd><p>the number of features randomly sampled at each split
    in the random forest classifier; defaults to <code>2</code></p></dd>
  <dt>"trees"</dt><dd><p>the number of trees in the random forest classifier;
    defaults to <code>100</code></p></dd>
  <dt>"min_n"</dt><dd><p>the minimum number of observations to split a node in the
    random forest classifier; defaults to <code>NULL</code></p></dd>
  <dt>"importance"</dt><dd><p>the method of calculating feature importances
    to use; defaults to <code>"accuracy"</code>; can also specify <code>"gini"</code></p></dd>

</dl></td>
    </tr>
    <tr>
      <th>lr_params</th>
      <td><p>for <code>classifier</code> == <code>"lr"</code>, a list of parameters
for the logistic regression models, containing the following items (see
<a href='https://parsnip.tidymodels.org/reference/logistic_reg.html'>logistic_reg</a> from the <code>parsnip</code> package):</p><dl>
  <dt>"mixture"</dt><dd><p>the proportion of L1 regularization in the model;
    defaults to <code>1</code></p></dd>
  <dt>"penalty"</dt><dd><p>the total amount of regularization in the model;
    defaults to <code>"auto"</code>, which uses <a href='https://glmnet.stanford.edu/reference/cv.glmnet.html'>cv.glmnet</a> to set
    the penalty</p></dd>

</dl></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>a list of class <code>"Augur"</code>, containing the following items:</p><ol>
<li><p><code>X</code>: the numeric matrix (or data frame or sparse matrix,
    depending on the input) containing gene expression values for each cell
    in the dataset</p></li>
<li><p><code>y</code>: the vector of experimental condition labels being predicted</p></li>
<li><p><code>cell_types</code>: the vector of cell type labels</p></li>
<li><p><code>parameters</code>: the parameters provided to this function as input</p></li>
<li><p><code>results</code>: the area under the curve for each cell type, in each
    fold, in each subsample, in the comparison of interest, as well as a
    series of other classification metrics</p></li>
<li><p><code>feature_importance</code>: the importance of each feature for
    calculating the AUC, above. For random forest classifiers, this is the
    mean decrease in accuracy or Gini index. For logistic regression
    classifiers, this is the standardized regression coefficients, computed
    using the Agresti method</p></li>
<li><p><code>AUC</code>: a summary of the mean AUC for each cell type (for
    continuous experimental conditions, this is replaced by a <code>CCC</code>
    item that records the mean concordance correlation coefficient for each
    cell type)</p></li>
</ol>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Prioritize cell types involved in a complex biological process by training a
machine-learning model to predict sample labels (e.g., disease vs. control,
treated vs. untreated, or time post-stimulus), and evaluate the performance
of the model in cross-validation.</p>
<p>If a <code>Seurat</code> object is provided as input, Augur will use the default
assay (i.e., whatever <a href='https://mojaveazure.github.io/seurat-object/reference/AssayData.html'>GetAssayData</a> returns) as input. To
use a different assay, provide the expression matrix and metadata as input
separately, using the <code>input</code> and <code>meta</code> arguments.</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Michael Skinnider</p>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by <a href='https://scholar.google.ca/scholar?hl=en&as_sdt=0%2C5&q=mikolajewicz+nicholas&oq='>Nicholas Mikolajewicz</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


