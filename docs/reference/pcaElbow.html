<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Quickly estimate the 'elbow' of a scree plot (PCA) — pcaElbow • scMiko</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Quickly estimate the 'elbow' of a scree plot (PCA) — pcaElbow" />
<meta property="og:description" content="This function uses a rough algorithm to estimate a sensible 'elbow' to
choose for a PCA scree plot of eigenvalues. The function looks at an initial arbitrarily 'low'
level of variance and looks for the first eigenvalue lower than this. If the very first eigenvalue
is actually lower than this (i.e, when the PCs are not very explanatory) then this 'low' value is
iteratively halved until this is no longer the case. After starting below this arbitrary threshold
the drop in variance explained by each pair of consecutive PCs is standardized by dividing over the
larger of the pair. The largest percentage drop in the series below 'low' " />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">scMiko</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Quickly estimate the 'elbow' of a scree plot (PCA)</h1>
    
    <div class="hidden name"><code>pcaElbow.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function uses a rough algorithm to estimate a sensible 'elbow' to
choose for a PCA scree plot of eigenvalues. The function looks at an initial arbitrarily 'low'
level of variance and looks for the first eigenvalue lower than this. If the very first eigenvalue
is actually lower than this (i.e, when the PCs are not very explanatory) then this 'low' value is
iteratively halved until this is no longer the case. After starting below this arbitrary threshold
the drop in variance explained by each pair of consecutive PCs is standardized by dividing over the
larger of the pair. The largest percentage drop in the series below 'low' <!-- % is selected as the 'elbow'. --></p>
    </div>

    <pre class="usage"><span class='fu'>pcaElbow</span><span class='op'>(</span><span class='va'>varpc</span>, low <span class='op'>=</span> <span class='fl'>0.08</span>, max.pc <span class='op'>=</span> <span class='fl'>0.9</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>varpc</th>
      <td><p>numeric, vector of eigenvalues, or 'percentage of variance' explained datapoints for
each principle component. If only using a partial set of components, should first pass to
estimate.eig.vpcs() to estimate any missing eigenvalues.</p></td>
    </tr>
    <tr>
      <th>low</th>
      <td><p>numeric, between zero and one, the threshold to define that a principle component
does not explain much 'of the variance'.</p></td>
    </tr>
    <tr>
      <th>max.pc</th>
      <td><p>maximum percentage of the variance to capture before the elbow (cumulative sum to PC 'n')</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The number of last principle component to keep, prior to the determined elbow cutoff</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Nicholas Cooper</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># correlated data</span>
<span class='va'>mat</span> <span class='op'>&lt;-</span> <span class='fu'>sim.cor</span><span class='op'>(</span><span class='fl'>100</span>,<span class='fl'>50</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='error'>Error in sim.cor(100, 50): could not find function "sim.cor"</span></div><div class='input'><span class='va'>result</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/princomp.html'>princomp</a></span><span class='op'>(</span><span class='va'>mat</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='error'>Error in princomp(mat): object 'mat' not found</span></div><div class='input'><span class='va'>eig</span> <span class='op'>&lt;-</span> <span class='va'>result</span><span class='op'>$</span><span class='va'>sdev</span><span class='op'>^</span><span class='fl'>2</span>
</div><div class='output co'>#&gt; <span class='error'>Error in eval(expr, envir, enclos): object 'result' not found</span></div><div class='input'><span class='va'>elb.a</span> <span class='op'>&lt;-</span> <span class='fu'>quick.elbow</span><span class='op'>(</span><span class='va'>eig</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='error'>Error in quick.elbow(eig): could not find function "quick.elbow"</span></div><div class='input'><span class='fu'>pca.scree.plot</span><span class='op'>(</span><span class='va'>eig</span>,elbow<span class='op'>=</span><span class='va'>elb.a</span>,M<span class='op'>=</span><span class='va'>mat</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='error'>Error in pca.scree.plot(eig, elbow = elb.a, M = mat): could not find function "pca.scree.plot"</span></div><div class='input'><span class='va'>elb.b</span> <span class='op'>&lt;-</span> <span class='fu'>quick.elbow</span><span class='op'>(</span><span class='va'>eig</span>,low<span class='op'>=</span><span class='fl'>.05</span><span class='op'>)</span> <span class='co'># decrease 'low' to select more components</span>
</div><div class='output co'>#&gt; <span class='error'>Error in quick.elbow(eig, low = 0.05): could not find function "quick.elbow"</span></div><div class='input'><span class='fu'>pca.scree.plot</span><span class='op'>(</span><span class='va'>eig</span>,elbow<span class='op'>=</span><span class='va'>elb.b</span>,M<span class='op'>=</span><span class='va'>mat</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='error'>Error in pca.scree.plot(eig, elbow = elb.b, M = mat): could not find function "pca.scree.plot"</span></div><div class='input'><span class='co'># random (largely independent) data, usually higher elbow #</span>
<span class='va'>mat2</span> <span class='op'>&lt;-</span> <span class='fu'>generate.test.matrix</span><span class='op'>(</span><span class='fl'>5</span>,<span class='fl'>3</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='error'>Error in generate.test.matrix(5, 3): could not find function "generate.test.matrix"</span></div><div class='input'><span class='va'>result2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/princomp.html'>princomp</a></span><span class='op'>(</span><span class='va'>mat2</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='error'>Error in princomp(mat2): object 'mat2' not found</span></div><div class='input'><span class='va'>eig2</span> <span class='op'>&lt;-</span> <span class='va'>result2</span><span class='op'>$</span><span class='va'>sdev</span><span class='op'>^</span><span class='fl'>2</span>
</div><div class='output co'>#&gt; <span class='error'>Error in eval(expr, envir, enclos): object 'result2' not found</span></div><div class='input'><span class='va'>elb2</span> <span class='op'>&lt;-</span> <span class='fu'>quick.elbow</span><span class='op'>(</span><span class='va'>result2</span><span class='op'>$</span><span class='va'>sdev</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='error'>Error in quick.elbow(result2$sdev^2): could not find function "quick.elbow"</span></div><div class='input'><span class='fu'>pca.scree.plot</span><span class='op'>(</span><span class='va'>eig2</span>,elbow<span class='op'>=</span><span class='va'>elb2</span>,M<span class='op'>=</span><span class='va'>mat2</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='error'>Error in pca.scree.plot(eig2, elbow = elb2, M = mat2): could not find function "pca.scree.plot"</span></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by <a href='https://scholar.google.ca/scholar?hl=en&as_sdt=0%2C5&q=mikolajewicz+nicholas&oq='>Nicholas Mikolajewicz</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


